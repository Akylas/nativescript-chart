import { ValueFormatter } from './ValueFormatter';

export class DefaultValueFormatter extends ValueFormatter {
    /**
     * DecimalFormat for formatting
     */
    protected formatter: NSNumberFormatter;

    protected decimals;

    /**
     * Constructor that specifies to how many digits the value should be
     * formatted.
     *
     * @param decimals
     */
    constructor(decimals) {
        super();
        this.setup(decimals);
    }

    /**
     * Sets up the formatter with a given number of decimal digits.
     *
     * @param digits
     */
    public setup(decimals) {
        this.decimals = decimals;

        // let b = '';
        // for (let i = 0; i < digits; i++) {
        //     if (i == 0) b += '.';
        //     b += '0';
        // }

        this.formatter =  NSNumberFormatter.new();
        this.formatter.usesGroupingSeparator = (true);
        this.formatter.minimumFractionDigits = (decimals);
        this.formatter.maximumFractionDigits = (decimals);
    }

    public getFormattedValue(value) {
        // put more logic here ...
        // avoid memory allocations here (for performance reasons)

        return this.formatter.stringFromNumber(value);
    }

    /**
     * Returns the number of decimal digits this formatter uses.
     *
     * @return
     */
    public getDecimalDigits() {
        return this.decimals;
    }
}
